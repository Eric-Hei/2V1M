[build]
  # Commande de build (installer les dépendances)
  command = "npm install"
  # Dossier à publier (fichiers statiques)
  publish = "public"
  # Fonction serverless
  functions = "netlify/functions"

[functions]
  # Inclure node_modules dans le bundle
  node_bundler = "esbuild"
  included_files = ["src/**"]

# Redirection pour le serveur Node.js
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/server/:splat"
  status = 200

# Redirection pour la vue joueur (client-side routing)
[[redirects]]
  from = "/party/*"
  to = "/index.html"
  status = 200

# Redirection pour la vue admin/spectateur (client-side routing)
[[redirects]]
  from = "/admin/*"
  to = "/index.html"
  status = 200

# Redirection pour le mode spectateur legacy (client-side routing)
[[redirects]]
  from = "/spectate/*"
  to = "/index.html"
  status = 200

# Redirection pour join legacy (client-side routing)
[[redirects]]
  from = "/join/*"
  to = "/index.html"
  status = 200

# Redirection par défaut
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[dev]
  # Port de développement local
  port = 3000
  # Commande pour démarrer le serveur local
  command = "npm start"

